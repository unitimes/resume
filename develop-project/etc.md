# 퍼시스턴스 레이어 분리
## 목적(WHY)
### 특정 퍼시스턴스 레이어 기술 노출 지양
퍼시스턴스 프레임워크로 ibatis, mybatis 모두를 혼용하고 있는 환경. 각 기술에 특화된 패턴과 구조를 가진 객체(ibatis-DAO, mybatis-Mapper)를 어플리케이션 전반에 거쳐 직접 의존성을 가짐.
기반 기술 은닉화를 통해 유지 보수 편이성 증대시킬 목적
## 구현 특이사항(HOW)
### Repository interface로 기반 기술 은닉화
Repository interface 참조로 퍼시스턴스 레이어 분리 및 기반 기술 직접 참조 지양
# 뷰 레이어 DTO 분리
## 목적(WHY)
### Command, Result 객체와 Domain model 객체간 의존성 약화
View layer와 data 통신에 사용되는 객체로 domain model 객체를 직접 사용하거나, domain model 객체를 확장(extends) 하는 등 강한 의존관계를 가지는 환경.
이로 인해 view layer가 두터워 지고, 관점 분리가 제대로 이루어 지지 않아 유지 보수에 어려움이 있음.
## 구현 특이사항(HOW)
### Facade 패턴 적용
View layer와 data 통신만을 목적으로 하는 DTO 객체 생성하여 사용.
## 얻은 것(RESULT)
### Thin view layer
Formatting, structuring 로직 감소.
유저 요구사항 변화에 적은 비용으로 대응할 수 있는 환경 조성.
View layer의 template engine에 적용 했던 로직을 controller layer에서 java 로직으로 대체하여 test coverage 확장 및 디버깅 용이성 향상.
# 쿼리 내 비지니스 로직 이관
## 목적(WHY)
### 유지보수 편이성 증가
복잡한 비지니스 로직이 수백줄의 SQL문으로 다수 작성 되어 있어 이해가 어려움. 일부 성능 나쁜 동일 DB link에 join 목적으로 복수번 조회를 하는 등 성능 저하 이슈 존재.
JAVA 로 전환하여 비지니스 이해를 용이하게 하고 메모리를 사용하여 불필요한 DB 조회를 지양.
## 구현 특이사항(HOW)
### 니즈 기반 리팩토링
SQL로 되어 있는 비지니스 로직의 양이 상당하고 작성이 복잡하게 되어 있어 전면적인 리팩토링에는 상당한 비용 투입이 필요. 철학이 다른 언어로의 전환이기 때문에 로직 이관 후 정상 작동 여부 확인이 어려움.
운영 이슈, 로직 변경 등 기 SQL 로직을 다루어야 하는 니즈가 있을 때 관련 부분만을 분리하여 로직 이관 리팩토링 수행.
### 성능 이슈 고려한 역할 분리
메모리 관리, 처리 성능 등의 이유로 DB가 처리하기에 적합한 비지니스 로직이 존재(다수 데이터에 대한 통계 등).
하나의 SQL로 되어 있는 복잡한 비지니스 로직을 분리하여 성격에 따라 일부는 단순한 SQL 문들로 일부는 JAVA로 리팩토링.
